# Сервер изображений

Сервер на Node.js для загрузки и обработки изображений.

## Особенности

- Загрузка изображений через API
- Сохранение изображений в указанную директорию
- Получение изображений по URL
- Поддержка вложенных директорий
- Проверка типа файла и размера
- Защита от path traversal атак

## Требования

- Node.js 14.x или выше
- npm или yarn

## Установка

1. Клонируйте репозиторий:
```bash
git clone <url-репозитория>
cd imageServer
```

2. Установите зависимости:
```bash
npm install
```

3. Соберите проект:
```bash
npm run build
```

4. Запустите сервер:
```bash
npm start
```

По умолчанию сервер будет доступен по адресу http://localhost:3000

## Конфигурация

Настройки сервера находятся в файле `src/config/config.ts`:

- `port`: Порт для запуска сервера (по умолчанию 3000)
- `uploadsDir`: Директория для сохранения изображений
- `maxFileSize`: Максимальный размер файла (в байтах)
- `allowedMimeTypes`: Разрешенные типы файлов

## API

### Веб-интерфейс для загрузки

```
GET /upload-ui
```

Предоставляет удобный веб-интерфейс для загрузки отдельных изображений через браузер.

### Веб-интерфейс для пакетной загрузки

```
GET /batch-upload-ui
```

Предоставляет веб-интерфейс для пакетной загрузки нескольких изображений (до 10 файлов одновременно).

### Информационная страница

```
GET /info
```

Предоставляет общую информацию о доступных функциях сервера.

### Загрузка изображения

```
POST /upload
```

**Form-data параметры:**
- `image`: Файл изображения (обязательно)
- `path`: Относительный путь для сохранения (например, "users/avatars") (опционально)

**Ответ:**
```json
{
  "success": true,
  "filename": "1630506895123-123456789.jpg",
  "path": "users/avatars/1630506895123-123456789.jpg",
  "url": "http://localhost:3000/users/avatars/1630506895123-123456789.jpg",
  "message": "Файл успешно загружен"
}
```

### Пакетная загрузка изображений

```
POST /batch-upload
```

**Form-data параметры:**
- `images`: Файлы изображений (до 10 файлов, обязательно)
- `path`: Относительный путь для сохранения (например, "users/avatars") (опционально)

**Ответ:**
```json
{
  "success": true,
  "message": "Успешно загружено 3 файлов",
  "files": [
    {
      "filename": "1630506895123-123456789.jpg",
      "originalname": "photo1.jpg",
      "path": "users/avatars/1630506895123-123456789.jpg",
      "url": "http://localhost:3000/users/avatars/1630506895123-123456789.jpg",
      "size": 45678,
      "mimetype": "image/jpeg"
    }
  ],
  "totalCount": 3
}
```

### Получение изображения

```
GET /{path}
```

**Параметры URL:**
- `path`: Относительный путь к изображению

## Разработка

Для запуска сервера в режиме разработки:

```bash
npm run dev
```

## Лицензия

ISC
